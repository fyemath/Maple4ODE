<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Topic 7 Linear systems | Maple for Differential Equations</title>
  <meta name="description" content="This is a notebook in progress on Maple for differential equations. This notebook was created using bookdown" />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="Topic 7 Linear systems | Maple for Differential Equations" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is a notebook in progress on Maple for differential equations. This notebook was created using bookdown" />
  <meta name="github-repo" content="fyemath/maple4ode" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Topic 7 Linear systems | Maple for Differential Equations" />
  
  <meta name="twitter:description" content="This is a notebook in progress on Maple for differential equations. This notebook was created using bookdown" />
  

<meta name="author" content="Fei Ye" />


<meta name="date" content="2021-12-08" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="laplace-transform-methods.html"/>

<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>




<link rel="stylesheet" href="css/style.css" type="text/css" />
<link rel="stylesheet" href="css/thm.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Maple for ODE</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="basics-in-maple.html"><a href="basics-in-maple.html"><i class="fa fa-check"></i><b>1</b> Basics in Maple</a>
<ul>
<li class="chapter" data-level="1.1" data-path="basics-in-maple.html"><a href="basics-in-maple.html#getting-started"><i class="fa fa-check"></i><b>1.1</b> Getting Started</a></li>
<li class="chapter" data-level="1.2" data-path="basics-in-maple.html"><a href="basics-in-maple.html#operators-variables-and-delimiters"><i class="fa fa-check"></i><b>1.2</b> Operators, Variables, and Delimiters</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="basics-in-maple.html"><a href="basics-in-maple.html#basic-operators"><i class="fa fa-check"></i><b>1.2.1</b> Basic Operators</a></li>
<li class="chapter" data-level="1.2.2" data-path="basics-in-maple.html"><a href="basics-in-maple.html#variables"><i class="fa fa-check"></i><b>1.2.2</b> Variables</a></li>
<li class="chapter" data-level="1.2.3" data-path="basics-in-maple.html"><a href="basics-in-maple.html#delimiters"><i class="fa fa-check"></i><b>1.2.3</b> Delimiters</a></li>
<li class="chapter" data-level="1.2.4" data-path="basics-in-maple.html"><a href="basics-in-maple.html#statement-separator"><i class="fa fa-check"></i><b>1.2.4</b> Statement Separator</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="basics-in-maple.html"><a href="basics-in-maple.html#functions-and-evaluation"><i class="fa fa-check"></i><b>1.3</b> Functions and Evaluation</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="basics-in-maple.html"><a href="basics-in-maple.html#how-to-define-a-function"><i class="fa fa-check"></i><b>1.3.1</b> How to define a function</a></li>
<li class="chapter" data-level="1.3.2" data-path="basics-in-maple.html"><a href="basics-in-maple.html#initially-known-mathematical-functions"><i class="fa fa-check"></i><b>1.3.2</b> Initially known mathematical functions</a></li>
<li class="chapter" data-level="1.3.3" data-path="basics-in-maple.html"><a href="basics-in-maple.html#evaluation-and-substitution"><i class="fa fa-check"></i><b>1.3.3</b> Evaluation and Substitution</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="basics-in-maple.html"><a href="basics-in-maple.html#packages-and-plotting"><i class="fa fa-check"></i><b>1.4</b> Packages and Plotting</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="basics-in-maple.html"><a href="basics-in-maple.html#frequently-used-packages-and-how-to-load-them"><i class="fa fa-check"></i><b>1.4.1</b> Frequently used packages and how to load them</a></li>
<li class="chapter" data-level="1.4.2" data-path="basics-in-maple.html"><a href="basics-in-maple.html#plot-explicit-functions"><i class="fa fa-check"></i><b>1.4.2</b> Plot explicit functions</a></li>
<li class="chapter" data-level="1.4.3" data-path="basics-in-maple.html"><a href="basics-in-maple.html#plot-implicit-functions"><i class="fa fa-check"></i><b>1.4.3</b> Plot implicit functions</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="basics-in-maple.html"><a href="basics-in-maple.html#differentiation-and-integration"><i class="fa fa-check"></i><b>1.5</b> Differentiation and Integration</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="introduction-to-differential-equations.html"><a href="introduction-to-differential-equations.html"><i class="fa fa-check"></i><b>2</b> Introduction to Differential Equations</a>
<ul>
<li class="chapter" data-level="2.1" data-path="introduction-to-differential-equations.html"><a href="introduction-to-differential-equations.html#basic-concepts"><i class="fa fa-check"></i><b>2.1</b> Basic concepts</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="introduction-to-differential-equations.html"><a href="introduction-to-differential-equations.html#how-to-define-a-differential-equation-in-maple"><i class="fa fa-check"></i><b>2.1.1</b> How to define a differential equation in Maple</a></li>
<li class="chapter" data-level="2.1.2" data-path="introduction-to-differential-equations.html"><a href="introduction-to-differential-equations.html#how-to-check-solutions"><i class="fa fa-check"></i><b>2.1.2</b> How to check solutions</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="introduction-to-differential-equations.html"><a href="introduction-to-differential-equations.html#solution-curves-vs-integral-curves"><i class="fa fa-check"></i><b>2.2</b> Solution curves vs Integral curves</a></li>
<li class="chapter" data-level="2.3" data-path="introduction-to-differential-equations.html"><a href="introduction-to-differential-equations.html#direction-fields"><i class="fa fa-check"></i><b>2.3</b> Direction fields</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="first-order-differential-equations.html"><a href="first-order-differential-equations.html"><i class="fa fa-check"></i><b>3</b> First Order Differential Equations</a>
<ul>
<li class="chapter" data-level="3.1" data-path="first-order-differential-equations.html"><a href="first-order-differential-equations.html#classification"><i class="fa fa-check"></i><b>3.1</b> Classification</a></li>
<li class="chapter" data-level="3.2" data-path="first-order-differential-equations.html"><a href="first-order-differential-equations.html#solving-differential-equations"><i class="fa fa-check"></i><b>3.2</b> Solving differential equations</a></li>
<li class="chapter" data-level="3.3" data-path="first-order-differential-equations.html"><a href="first-order-differential-equations.html#integrating-factors"><i class="fa fa-check"></i><b>3.3</b> Integrating factors</a></li>
<li class="chapter" data-level="3.4" data-path="first-order-differential-equations.html"><a href="first-order-differential-equations.html#commands-for-specific-type-of-equations"><i class="fa fa-check"></i><b>3.4</b> Commands for specific type of equations</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="linear-second-order-differential-equations.html"><a href="linear-second-order-differential-equations.html"><i class="fa fa-check"></i><b>4</b> Linear Second Order Differential Equations</a>
<ul>
<li class="chapter" data-level="4.1" data-path="linear-second-order-differential-equations.html"><a href="linear-second-order-differential-equations.html#the-general-solution-of-a-linear-equation"><i class="fa fa-check"></i><b>4.1</b> The general solution of a linear equation</a></li>
<li class="chapter" data-level="4.2" data-path="linear-second-order-differential-equations.html"><a href="linear-second-order-differential-equations.html#wronskian-of-solutions"><i class="fa fa-check"></i><b>4.2</b> Wronskian of Solutions</a></li>
<li class="chapter" data-level="4.3" data-path="linear-second-order-differential-equations.html"><a href="linear-second-order-differential-equations.html#linear-equations-with-constant-coefficients"><i class="fa fa-check"></i><b>4.3</b> Linear Equations with Constant Coefficients</a></li>
<li class="chapter" data-level="4.4" data-path="linear-second-order-differential-equations.html"><a href="linear-second-order-differential-equations.html#undetermined-coefficients"><i class="fa fa-check"></i><b>4.4</b> Undetermined Coefficients</a></li>
<li class="chapter" data-level="4.5" data-path="linear-second-order-differential-equations.html"><a href="linear-second-order-differential-equations.html#reduction-of-order"><i class="fa fa-check"></i><b>4.5</b> Reduction of Order</a></li>
<li class="chapter" data-level="4.6" data-path="linear-second-order-differential-equations.html"><a href="linear-second-order-differential-equations.html#variation-of-parameters"><i class="fa fa-check"></i><b>4.6</b> Variation of Parameters</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="series-solutions.html"><a href="series-solutions.html"><i class="fa fa-check"></i><b>5</b> Series Solutions</a>
<ul>
<li class="chapter" data-level="5.1" data-path="series-solutions.html"><a href="series-solutions.html#power-series-solutions"><i class="fa fa-check"></i><b>5.1</b> Power series solutions</a></li>
<li class="chapter" data-level="5.2" data-path="series-solutions.html"><a href="series-solutions.html#euler-equations"><i class="fa fa-check"></i><b>5.2</b> Euler Equations</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="laplace-transform-methods.html"><a href="laplace-transform-methods.html"><i class="fa fa-check"></i><b>6</b> Laplace Transform Methods</a>
<ul>
<li class="chapter" data-level="6.1" data-path="laplace-transform-methods.html"><a href="laplace-transform-methods.html#laplace-transforms-and-inverse-transforms"><i class="fa fa-check"></i><b>6.1</b> Laplace Transforms and Inverse Transforms</a></li>
<li class="chapter" data-level="6.2" data-path="laplace-transform-methods.html"><a href="laplace-transform-methods.html#transforms-of-initial-value-problems"><i class="fa fa-check"></i><b>6.2</b> Transforms of Initial Value Problems</a></li>
<li class="chapter" data-level="6.3" data-path="laplace-transform-methods.html"><a href="laplace-transform-methods.html#partial-fractional-decomposition-method"><i class="fa fa-check"></i><b>6.3</b> Partial Fractional Decomposition Method</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="linear-systems.html"><a href="linear-systems.html"><i class="fa fa-check"></i><b>7</b> Linear systems</a>
<ul>
<li class="chapter" data-level="7.1" data-path="linear-systems.html"><a href="linear-systems.html#eigenvalues-and-eigenvectors"><i class="fa fa-check"></i><b>7.1</b> Eigenvalues and Eigenvectors</a></li>
<li class="chapter" data-level="7.2" data-path="linear-systems.html"><a href="linear-systems.html#solving-linear-system-of-ode"><i class="fa fa-check"></i><b>7.2</b> Solving Linear System of ODE</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Maple for Differential Equations</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="linear-systems" class="section level1" number="7">
<h1><span class="header-section-number">Topic 7</span> Linear systems</h1>
<p>Given a linear system of first order differential equation with constant coefficients
<span class="math display">\[
\vec{y}&#39;=A\vec{y},
\]</span>
the general solution is in the form
<span class="math display">\[
\vec{y}=e^{At}\vec{c},
\]</span>
where
<span class="math display">\[e^{At}=\sum\limits_{n=0}^\infty \frac{A^nt^n}{n!}.\]</span></p>
<p>It it known that for a matrix <span class="math inline">\(A\)</span>, there is a matrix <span class="math inline">\(P\)</span> consists of eigenvectors and generalized eigenvectors such that <span class="math inline">\(PAP^{-1}\)</span> is in the form
<span class="math display">\[
\begin{pmatrix}
  J_1 &amp; &amp; \\
      &amp;\ddots &amp; \\
      &amp; &amp; J_r
\end{pmatrix},
\]</span>
where <span class="math inline">\(J_k\)</span> are the Jordan blocks.</p>
<p>For a <span class="math inline">\(2\times 2\)</span> matrix <span class="math inline">\(A\)</span>, if it has two distinct eigenvalues <span class="math inline">\(\lambda_1\)</span> and <span class="math inline">\(\lambda_2\)</span>, then
<span class="math display">\[
e^{At}=\begin{pmatrix}
  e^{\lambda_1 t}\vec{u} &amp; e^{\lambda_1 t}\vec{v}
\end{pmatrix}P^{-1},
\]</span>
where <span class="math inline">\(\vec{u}\)</span> and <span class="math inline">\(\vec{v}\)</span> are eigenvectors associated to <span class="math inline">\(\lambda_1\)</span> and <span class="math inline">\(\lambda_2\)</span> respectively, and <span class="math inline">\(P=\begin{pmatrix}\vec{u} &amp; \vec{v}\end{pmatrix}\)</span>.</p>
<p>If it has a repeated eigenvalue <span class="math inline">\(\lambda\)</span>, let <span class="math inline">\(\vec{u}\)</span> be a eigenvector and <span class="math inline">\(\vec{v}\)</span> a generalized eigenvector such that <span class="math inline">\((A-\lambda I)\vec{v}=\vec{u}\)</span>, then
<span class="math display">\[
e^{At}=\begin{pmatrix}
  e^{\lambda t}\vec{u} &amp; te^{\lambda t}\vec{u} + e^{\lambda t}\vec{v}
\end{pmatrix}P^{-1},
\]</span>
where <span class="math inline">\(P=\begin{pmatrix}  \vec{u} &amp; \vec{v} \end{pmatrix}\)</span>.</p>
<p>So to solve a linear system of first-order differential equations, we need to find eigenvalues and associated eigenvectors or generalized eigenvectors.</p>
<div id="eigenvalues-and-eigenvectors" class="section level2" number="7.1">
<h2><span class="header-section-number">7.1</span> Eigenvalues and Eigenvectors</h2>
<p>In Maple, eigenvalues, eigenvectors can be found using the command <code>Eigenvectors</code> which is supported by the package <code>LinearAlgebra</code>.</p>
<p>To construct a matrix or vector in Maple, one can use the <code>Matrix()</code> or <code>Vector()</code> command, or the shortcut notation <code>&lt;...&gt;</code>.</p>
<div class="example">
<p><span id="exm:unlabeled-div-92" class="example"><strong>Example 7.1  </strong></span>Find the eigenvalues and associated generalized eigenvectors of the matrix
<span class="math display">\[
A:=\begin{pmatrix}
  -1&amp;3\\-3&amp;5
\end{pmatrix}
\]</span></p>
</div>
<div class="solution">
<p><span id="unlabeled-div-93" class="solution"><em>Solution</em>. </span>Define the matrix using the shortcut notation.</p>
<pre><code>A:=&lt; &lt;-1, -3&gt; | &lt;3, 5&gt; &gt; # or A:=Matrix(2,2, [-1,3,-3,5])</code></pre>
<p>Load the package <code>LinearAlgebra</code>.</p>
<pre><code>with(LinearAlgebra)</code></pre>
<p>Find eigenvalues and eigenvectors of <span class="math inline">\(A\)</span>.</p>
<pre><code>Eigen:=Eigenvectors(A)</code></pre>
<p>The output is
<span class="math display">\[
{\color{blue}
{\begin{bmatrix}
  2\\2
\end{bmatrix},\begin{bmatrix}
  1 &amp; 0
\\
 1 &amp; 0
\end{bmatrix}
}}.
\]</span></p>
<p>From the output, we see that <span class="math inline">\(1\)</span> is a repeated eigenvalue. The first colum in the square matrix is an eigenvector of the eigenvalue. Since the eigenvalue is repeated, there will be a generalized eigenvector. The following Maple codes shows how to find it.</p>
<pre><code>IdM:=IdentityMatrix(2): # define a 2-by-2 identity matrix
u:=Column(Eigen[2],1): # extract the eigenvector
v:=LinearSolve(A-2*IdM, u); # solve for a generalized eigenvector</code></pre>
<p>The output shows
<span class="math display">\[
{\color{blue}{
\begin{bmatrix}
  -\frac{1}{3}+\_t_{2}
\\
 \_t_{2}
\end{bmatrix}
}},
\]</span>
where <span class="math inline">\(\_t_{2}\)</span> is a free variable that can take any value. For example, taking <span class="math inline">\(\_t_{2}=\frac13\)</span> and then multiply it by 3 yields an eigenvector
<span class="math display">\[
\begin{pmatrix}
  0
\\
 1
\end{pmatrix}.
\]</span></p>
</div>
<div class="exercise">
<p><span id="exr:unlabeled-div-94" class="exercise"><strong>Exercise 7.1  </strong></span>Find the eigenvalues and associated eigenvectors of the matrix
<span class="math display">\[
A:=\begin{pmatrix}
  5&amp;-3\\6&amp;-4
\end{pmatrix}
\]</span></p>
</div>
</div>
<div id="solving-linear-system-of-ode" class="section level2" number="7.2">
<h2><span class="header-section-number">7.2</span> Solving Linear System of ODE</h2>
<p>In Maple, to solve a linear system of first-order differential equations, one can use the command <code>dsolve</code>. Note that in Maple, the matrix multiplication operator is the <code>.</code> symbol instead of the <code>*</code> symbol. The <code>*</code> symbol is to be used for scalar multiplication.</p>
<div class="example">
<p><span id="exm:unlabeled-div-95" class="example"><strong>Example 7.2  </strong></span>Solve the linear system
<span class="math display">\[
\begin{pmatrix}
y_1&#39; \\ y_2&#39;
\end{pmatrix}
=
\begin{pmatrix}
-1&amp;3\\-3&amp;5
\end{pmatrix}\begin{pmatrix}
y_1 \\ y_2
\end{pmatrix}.
\]</span></p>
</div>
<div class="solution">
<p><span id="unlabeled-div-96" class="solution"><em>Solution</em>. </span>Define the linear system in matrix form.</p>
<pre><code>M := Matrix(2, 2, [-1, 3, -3, 5]):
Y := &lt;y[1](x), y[2](x)&gt;:
LinSys := diff(Y, x) = M . Y;</code></pre>
<p>Solve the linear system</p>
<pre><code>dsolve(LinSys, Y);</code></pre>
<p>The output shows the general solution as</p>
<p><span class="math display">\[
{\color{blue}
{\begin{pmatrix}
y_1(x
\\
y_2(x)  
\end{pmatrix}
=
\begin{pmatrix}
\frac{e^{2 x}(3 \_C2 x +3 \_C1 -\_C2 )}{3}
\\
e^{2 x}(\_C2 x +\_C1 )
\end{pmatrix}
}}.
\]</span></p>
</div>
<div class="exercise">
<p><span id="exr:unlabeled-div-97" class="exercise"><strong>Exercise 7.2  </strong></span>Solve the linear system
<span class="math display">\[
\begin{pmatrix}
y_1&#39; \\ y_2&#39;
\end{pmatrix}
=
\begin{pmatrix}
5&amp;-3\\4&amp;-2
\end{pmatrix}\begin{pmatrix}
y_1 \\ y_2
\end{pmatrix}.
\]</span></p>
</div>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="laplace-transform-methods.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": false,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/fyemath/maple4ode/06-LinearSystems.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["maple4ODE.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
